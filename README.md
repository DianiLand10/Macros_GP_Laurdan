# GP_MiceSperm
Fiji/ImageJ Macros for Semi-Automated ROI Extraction and GP Calculation
This repository contains two custom ImageJ/Fiji macros designed to streamline the processing of dual-channel confocal images and quantify the Generalized Polarization (GP) or similar normalized ratiometric intensity differences.

ðŸ›  Prerequisites
Fiji (ImageJ): These scripts are written in the ImageJ Macro Language (IJM) and run natively in Fiji. Download Fiji here.

Input Data: Multi-channel (minimum 2 slices/channels) .tif or .tiff images.

âš ï¸ Important Configuration Before First Use
Both macros contain hardcoded output directories tailored to the original author's machine. Before running these macros, you must open the .ijm files in a text editor (or the Fiji script editor) and modify the baseDir variable to point to a valid folder on your computer.

Find this line in both scripts and update the path:

// Change this path to your desired output folder
baseDir = "C:/Your/Path/Here/";

ðŸ’» Macro 1: Semi-Automated Cropping & Channel Splitting
Filename: 1_Crop_and_Split.ijm (Change to match your actual file name)

This script standardizes the extraction of a Region of Interest (ROI) across two channels and saves them as independent files.

How to use:

Drag and drop your raw multi-channel confocal image into Fiji.

Run the macro (Plugins > Macros > Run...).

The script will automatically place a 180 Ã— 180 pixel bounding box on the image.

A dialog box will appear. Pause and manually adjust the position and size of the bounding box to perfectly frame your biological structure of interest.

Click OK on the dialog box.

The script will duplicate the selected ROI for slice 1 (Channel 1) and slice 2 (Channel 2), save them as separate .tif files in a TwoChannels subfolder, and close the original image to free up memory.

ðŸ’» Macro 2: Ratiometric GP Quantification
Filename: 2_Calculate_GP.ijm (Change to match your actual file name)

This script calculates the normalized difference index between two open images using their global mean intensities. It applies the following equation:

GP =[(Channel 1-Channel 2)/(Channel 1 +Channel 2)] 
where Channel and Channel 2 represent the fluorescence intensity emitted at 430-470 nm and 505-605 nm, respectively. 

How to use:

Ensure that exactly two images are open in Fiji (e.g., the _Ch1.tif and _Ch2.tif images generated by Macro 1).

Run the macro.

The script will measure the mean intensity of both images.

It will calculate the subtracted value, the added value, and the final GP ratio.

The results are printed to the ImageJ Log window, appended to the Results Table, and automatically saved as a .csv file in a GP_Values subfolder.
